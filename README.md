# BofhContract

BofhContract.sol implements on-chain execution of swap paths. It stores and manages its own wallet of credit for 
the base L2 token which - at deploy time - is specified for the contract instance.

## Implemented features:

- contract instance lifecycle management
- management of on-contract stored funds (for a single base token)
- token-agnostic (base token is set at deploy time, not hardwired) 
- basic single-admin ACL
- transferable ownership of admin rights
- support for deferred funding injections
- support for funding retrieval
- multi-way swap with no explicit limitation
- multi-exchange router implementation (at the time, only compatible with UniswapV2 compliant pools)

## How to instantiate the contract for production use:

The short version:

- sign a contract deploy transaction
- approve some balance amount of the base token to the contract address
- call `adoptAllowance()`

## How to retrieve stored funds:

- call `withdrawFunds()`

## How to kill a contract instance

- call `kill()`
- This also returns any stored funding to the caller

## How to replace the admin address

- call `changeAdmin(newAddress)`


## Revert error messages:

| Message | Condition 	|
|---	  |---	        |
| `BOFH:SUX2BEU` 	                | Unauthorized call. (Call must be signed by current admin address)	|
| `BOFH:TRANSFER_FAILED` 	        |  Failed token fund transfer to the swap path's entry pool	|
| `BOFH:PAIR_NOT_IN_PATH` 	        | One of the pools in the swap list breaks the path 	|
| `BOFH:INSUFFICIENT_INPUT_AMOUNT` 	| During the path execution, the current token balance decreased to zero 	|
| `BOFH:INSUFFICIENT_LIQUIDITY`	    | During the path execution, a pair was found with no liquidity 	|
| `BOFH:PATH_TOO_SHORT` 	        |  Minimum swap path length is 2	|
| `BOFH:GIMMIE_MONEY`	            | Current contract funds are < than the required initialAmount 	|
| `BOFH:NON_CIRCULAR_PATH` 	        | The proposed swap path does not terminate with the base token 	|
| `BOFH:GREED_IS_GOOD` 	            | The final balance of the swap path does not meet or exceed the specified expectedFinalAmount constraint 	|
 
Any error string not starting in `BOFH:` is being generated by calls dispatched to external contracts such as tokens and pools.
